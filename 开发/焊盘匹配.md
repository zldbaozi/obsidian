GerberParser.cpp
```C++
#include "GerberParser.hh"

#include <QtMath>

  

namespace Vision

{

    // 内部辅助函数：判断两个浮点数是否近似相等

    static bool IsDoubleEqual(double v1, double v2, double epsilon = 0.001)

    {

        return qAbs(v1 - v2) < epsilon;

    }

  

    // 内部辅助函数：计算中心到轮廓点的最大距离（旋转不变特征）

    static double GetMaxDistanceFromCenter(GerberPad* pad)

    {

        if (!pad) return 0.0;   //空指针保护

        // 使用旋转矩形的中心，通常比boundingbox中心准确

        QPointF center = pad->rotateBox.center;  //指针类型变量，用->来访问它里面的东西，如果是普通变量就用.

        const QVector<QPointF>& points = pad->points; //const: 意思是“我只看不改”。保证不会如果不小心改动了数据;& (引用): 意思是“别把这个数组复制一份给我，直接把原件给我看”，这样速度快。
        
        double maxDistSq = 0.0;

        if (points.isEmpty()) {

            // 如果轮廓点为空，使用旋转盒尺寸估算

            double w = pad->rotateBox.width;

            double h = pad->rotateBox.height;

            maxDistSq = (w * w + h * h) / 4.0;

        } else {

            for (const QPointF& pt : points) {

                double distSq = qPow(pt.x() - center.x(), 2.0) + qPow(pt.y() - center.y(), 2.0);

                if (distSq > maxDistSq) {

                    maxDistSq = distSq;

                }

            }

        }

        return qSqrt(maxDistSq);

    }

  

    // 内部辅助函数：判断两个焊盘是否同类型

    static bool IsSameType(GerberPad* p1, GerberPad* p2)

    {

        if (!p1 || !p2) return false;

        if (p1 == p2) return true;

  

        // 1. 面积必须近似

        if (!IsDoubleEqual(p1->area, p2->area)) return false;

  

        // 2. 轮廓点数量必须一致

        if (p1->points.size() != p2->points.size()) return false;

  

        // 3. 几何特征（中心到最大轮廓距离）必须近似

        double dist1 = GetMaxDistanceFromCenter(p1);

        double dist2 = GetMaxDistanceFromCenter(p2);

        if (!IsDoubleEqual(dist1, dist2)) return false;

  

        return true;

    }

  

    // --- 实现 MatchPads 功能 ---

    QList<GerberPad*> MatchPads(const QList<GerberPad*>& templates, const QList<GerberPad*>& allPads)

    {

        QList<GerberPad*> matchedPads;

        if (templates.isEmpty() || allPads.isEmpty()) {

            return matchedPads;

        }

  

        for (GerberPad* target : allPads) {

            bool matchFound = false;

            // 只要匹配任意一个模版即可

            for (GerberPad* templ : templates) {

                if (IsSameType(target, templ)) {

                    matchFound = true;

                    break;

                }

            }

            if (matchFound) {

                matchedPads.append(target);

            }

        }

        return matchedPads;

    }

}
```